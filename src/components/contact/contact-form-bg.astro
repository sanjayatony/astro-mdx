---
const { component_id, heading, content, button, background_image, form, contacts } = Astro.props;
const currentUrl = Astro.request.url;
//const siteKey = import.meta.env.PUBLIC_SITE_KEY;
const componentName = "contact-form-bg";
---

<div
    id="toast-success"
    class="hidden fixed right-4 bottom-4 items-center w-full max-w-xs p-4 rounded-lg shadow bg-primary-500 text-white"
    role="alert"
>
    <div class="ms-3 text-sm font-normal">Your message has been sent.</div>
    <button
        type="button"
        class="ms-auto -mx-1.5 -my-1.5 hover:text-gray-900 rounded-lg focus:ring-2 focus:ring-gray-300 inline-flex items-center justify-center h-8 w-8"
        data-dismiss-target="#toast-success"
        aria-label="Close"
    >
        <span class="sr-only">Close</span>
        <svg
            class="w-3 h-3"
            aria-hidden="true"
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 14 14"
        >
            <path
                stroke="currentColor"
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"></path>
        </svg>
    </button>
</div>
<section {...component_id ? { id: component_id } : {}} class=`${componentName}`>
    <div
        class="bg-no-repeat bg-cover bg-center bg-blue-900/60 bg-blend-multiply rounded-br-[128px]"
        style={`background-image: url(${background_image});`}
    >
        <div class="px-4 lg:pt-24 pt-8 pb-72 lg:pb-80 mx-auto max-w-2xl text-center lg:px-6">
            <h2 class="text-white">
                {heading}
            </h2>
            <p class="text-white">{content}</p>
        </div>
    </div>
    <div class="py-16 px-4 mx-auto mt-[-300px] md:-mt-96 max-w-screen-xl sm:py-24 lg:px-6">
        <form
            method="POST"
            id="contact-form"
            class="grid grid-cols-1 gap-8 p-6 mx-auto mb-16 max-w-screen-md bg-white border border-gray-200 shadow-sm lg:mb-28 dark:bg-gray-800 dark:border-gray-700 sm:grid-cols-2"
        >
            {
                form.first_name && (
                    <div>
                        <label
                            for="firstName"
                            class="block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300">
                            {form.first_name.label}
                        </label>
                        <input
                            type="text"
                            id="firstName"
                            name="firstName"
                            required
                            class="block p-3 w-full text-sm text-gray-900 bg-gray-50 border border-gray-300 shadow-sm focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500 dark:shadow-sm-light"
                            placeholder={form.first_name.placeholder}
                        />
                    </div>
                )
            }
            {
                form.last_name && (
                    <div>
                        <label
                            for="lastName"
                            class="block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300">
                            {form.last_name.label}
                        </label>
                        <input
                            type="text"
                            id="lastName"
                            name="lastName"
                            class="block p-3 w-full text-sm text-gray-900 bg-gray-50 border border-gray-300 shadow-sm focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500 dark:shadow-sm-light"
                        />
                    </div>
                )
            }
            {
                form.email && (
                    <div>
                        <label
                            for="email"
                            class="block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300">
                            {form.email.label}
                        </label>
                        <input
                            type="email"
                            id="email"
                            name="email"
                            required
                            class="shadow-sm bg-gray-50 border border-gray-300 text-gray-900 text-sm focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500 dark:shadow-sm-light"
                            placeholder={form.email.placeholder}
                        />
                    </div>
                )
            }
            {
                form.phone && (
                    <div>
                        <label
                            for="phoneNumber"
                            class="block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300">
                            {form.phone.label}
                        </label>
                        <input
                            type="text"
                            name="phoneNumber"
                            id="phoneNumber"
                            class="block p-3 w-full text-sm text-gray-900 bg-gray-50 border border-gray-300 shadow-sm focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500 dark:shadow-sm-light"
                        />
                    </div>
                )
            }
            {
                form.message && (
                    <div class="sm:col-span-2">
                        <label
                            for="message"
                            class="block mb-2 text-sm font-medium text-gray-900 dark:text-gray-400">
                            {form.message.label}
                        </label>
                        <textarea
                            id="message"
                            rows="6"
                            name="message"
                            required
                            class="block p-2.5 w-full text-sm text-gray-900 bg-gray-50 shadow-sm border border-gray-300 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
                            placeholder={form.message.placeholder}
                        />
                        <p class="mt-4 text-sm text-gray-500">
                            By submitting this form you agree to our{" "}
                            <a href="#" class="hover:underline">
                                terms and conditions
                            </a>{" "}
                            and our{" "}
                            <a href="#" class="hover:underline">
                                privacy policy
                            </a>{" "}
                            which explains how we may collect, use and disclose your personal
                            information including to third parties.
                        </p>
                    </div>
                )
            }
            {
                form.submit && (
                    <button
                        aria-label="Submit"
                        type="submit"
                        class="button xl primary inline-block w-48">
                        {form.submit.label}
                    </button>
                )
            }
            <input
                type="hidden"
                name="subject"
                value=`New Contact Form Submission | Bn2 Health - ${currentUrl}`
            />
            <input type="hidden" name="inbox_key" value="bn-form" />
            <input type="text" name="_gotcha" style="display: none;" />
            <input type="hidden" name="formType" value="contact" />
        </form>

        <div
            class="text-center flex flex-col md:flex-row items-center md:items-start justify-between gap-y-12 gap-x-16"
        >
            {
                contacts &&
                    contacts.length > 0 &&
                    contacts.map((contact) => (
                        <div class="md:1/3">
                            <div class="flex justify-center items-center mx-auto mb-4 w-24 h-24 rounded-full border-gradient">
                                <img src={contact.image} alt="" width={56} height={56} />
                            </div>
                            <span class="mb-2 h5">{contact.title}</span>
                            <p class="mb-3 max-w-64">{contact.content_textarea}</p>
                            {contact.cta.url &&
                                (contact.cta.is_button ? (
                                    <a
                                        href={contact.cta.url}
                                        target="_blank"
                                        class="button primary alt inline-flex items-center gap-2 group">
                                        {contact.cta.label}
                                        <svg
                                            class="w-4 h-4"
                                            viewBox="0 0 17 17"
                                            fill="none"
                                            xmlns="http://www.w3.org/2000/svg">
                                            <path
                                                fillRule="evenodd"
                                                clipRule="evenodd"
                                                d="M9.13636 3.72046C9.13636 3.44432 8.91251 3.22046 8.63636 3.22046H2C1.17157 3.22046 0.5 3.89203 0.5 4.72046V14.7205C0.5 15.5489 1.17157 16.2205 2 16.2205H12C12.8284 16.2205 13.5 15.5489 13.5 14.7205V8.0841C13.5 7.80795 13.2761 7.5841 13 7.5841C12.7239 7.5841 12.5 7.80795 12.5 8.0841V14.7205C12.5 14.9966 12.2761 15.2205 12 15.2205H2C1.72386 15.2205 1.5 14.9966 1.5 14.7205V4.72046C1.5 4.44432 1.72386 4.22046 2 4.22046H8.63636C8.91251 4.22046 9.13636 3.9966 9.13636 3.72046Z"
                                                class="fill-primary-700 group-hover:fill-white"
                                            />
                                            <path
                                                d="M16 5.72046V0.720459M16 0.720459H11M16 0.720459L7 9.72046"
                                                class="stroke-primary-700 group-hover:stroke-white"
                                                strokeLinecap="round"
                                                strokeLinejoin="round"
                                            />
                                            <path
                                                fillRule="evenodd"
                                                clipRule="evenodd"
                                                d="M16.5 0.720459C16.5 0.444317 16.2761 0.220459 16 0.220459H11C10.7239 0.220459 10.5 0.444317 10.5 0.720459C10.5 0.996601 10.7239 1.22046 11 1.22046H14.7929L6.64645 9.36691C6.45118 9.56217 6.45118 9.87875 6.64645 10.074C6.84171 10.2693 7.15829 10.2693 7.35355 10.074L15.5 1.92757V5.72046C15.5 5.9966 15.7239 6.22046 16 6.22046C16.2761 6.22046 16.5 5.9966 16.5 5.72046V0.720459Z"
                                                class="fill-primary-700 group-hover:fill-white"
                                            />
                                        </svg>
                                    </a>
                                ) : (
                                    <a href={contact.cta.url} class="font-semibold hover:underline">
                                        {contact.cta.label}
                                    </a>
                                ))}
                        </div>
                    ))
            }
        </div>
    </div>
</section>
<!-- <script is:inline src=`https://www.google.com/recaptcha/api.js?render=${siteKey}`></script>
<script>
    import setupForm from "../../helper/formHandler.js";
    setupForm("contact-form");
</script> -->
